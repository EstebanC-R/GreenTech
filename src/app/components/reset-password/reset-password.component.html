<div class="reset-password-container">
    <div class="reset-password-card">
    
        <!-- Loading token validation -->
        <div *ngIf="isCheckingToken" class="loading-container">
            <div class="spinner"></div>
            <p>Validando enlace...</p>
        </div>

        <!-- Invalid token -->
        <div *ngIf="!isCheckingToken && !isValidToken" class="invalid-token">
            <div class="error-icon">⚠️</div>
            <h3>Enlace inválido o expirado</h3>
            <p>{{ message || 'El enlace de restablecimiento no es válido o ha expirado.' }}</p>
            <button (click)="goToLogin()" class="btn btn-primary">
                Volver al login
            </button>
        </div>

        <!-- Valid token - Reset form -->
        <div *ngIf="!isCheckingToken && isValidToken && !isSuccess">
            <div class="reset-password-header">
                <h2>Restablecer contraseña</h2>
                <p>Ingresa tu nueva contraseña</p>
            </div>

            <form (ngSubmit)="onSubmit()">
                <div class="form-group">
                    <label for="newPassword">Nueva contraseña:</label>
                    <input 
                        type="password" 
                        id="newPassword"
                        [(ngModel)]="newPassword"
                        name="newPassword"
                        placeholder="Ingresa tu nueva contraseña"
                        [disabled]="isLoading"
                        required
                        minlength="6"
                    />
                </div>

                <div class="form-group">
                    <label for="confirmPassword">Confirmar contraseña:</label>
                    <input 
                        type="password" 
                        id="confirmPassword"
                        [(ngModel)]="confirmPassword"
                        name="confirmPassword"
                        placeholder="Confirma tu nueva contraseña"
                        [disabled]="isLoading"
                        required
                    />
                </div>

                <div *ngIf="message && !isSuccess" class="error-message">
                    {{ message }}
                </div>

                <button 
                    type="submit" 
                    class="btn btn-primary"
                    [disabled]="isLoading"
                    >
                    <span *ngIf="isLoading">Actualizando...</span>
                    <span *ngIf="!isLoading">Actualizar contraseña</span>
                </button>
            </form>
        </div>

        <!-- Success message -->
        <div *ngIf="!isCheckingToken && isSuccess" class="success-container">
            <div class="success-icon">✓</div>
            <h3>¡Contraseña actualizada!</h3>
            <p>{{ message }}</p>
            <p>Serás redirigido al login en unos segundos...</p>
            <button (click)="goToLogin()" class="btn btn-primary">
                Ir al login ahora
            </button>
        </div>

        <div class="back-to-login" *ngIf="!isCheckingToken && isValidToken && !isSuccess">
            <button (click)="goToLogin()" class="back-btn">
                <span class="back-arrow">←</span>
                <span>Volver al login</span>
            </button>
        </div>
    </div>
</div>